{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "6337b6a3",
   "metadata": {},
   "source": [
    "# Amortized Inference for a NLME Model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "6eb930b7",
   "metadata": {},
   "outputs": [],
   "source": [
    "# load necessary packages\n",
    "import numpy as np\n",
    "import pandas as pd\n",
    "import itertools\n",
    "\n",
    "# for plots\n",
    "import matplotlib.pyplot as plt\n",
    "from IPython.display import display\n",
    "from heatmap import corrplot\n",
    "\n",
    "# optimization\n",
    "from pypesto import visualize, optimize, profile, engine\n",
    "\n",
    "from inference.inference_functions import run_population_optimization, create_boundaries_from_prior\n",
    "from inference.nlme_objective import ObjectiveFunctionNLME\n",
    "from inference.helper_functions import transform_pesto_results\n",
    "from inference.ploting_routines import plot_real_vs_synthetic, plot_real_and_estimated, \\\n",
    "    plot_parameter_estimates, plot_estimated_distributions, visualize_pesto_result"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5fef8f8c",
   "metadata": {},
   "outputs": [],
   "source": [
    "# specify which model to use\n",
    "model_name = ['fröhlich-small', 'fröhlich-large', 'fröhlich-sde', 'pharmacokinetic_model', \n",
    "              'clairon_model', 'clairon_small_model'][4]"
   ]
  },
  {
   "cell_type": "markdown",
   "source": [],
   "metadata": {
    "collapsed": false
   },
   "id": "69580b6e4d571910"
  },
  {
   "cell_type": "markdown",
   "id": "7adcc9cd",
   "metadata": {},
   "source": [
    "## Load model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7c72e5e2",
   "metadata": {},
   "outputs": [],
   "source": [
    "if model_name == 'fröhlich-small':\n",
    "    from models.froehlich_model_small import FroehlichModelSmall\n",
    "    model = FroehlichModelSmall(load_best=True)\n",
    "    \n",
    "    use_presimulation = False\n",
    "elif model_name == 'fröhlich-large':\n",
    "    from models.froehlich_model_large import FroehlichModelLarge\n",
    "    model = FroehlichModelLarge(load_best=True)\n",
    "    \n",
    "    use_presimulation = True\n",
    "    presimulation_path = 'data/presimulations_froehlich_large'\n",
    "\n",
    "elif model_name == 'fröhlich-sde':\n",
    "    from models.froehlich_model_sde import FroehlichModelSDE\n",
    "    model = FroehlichModelSDE(load_best=True)\n",
    "\n",
    "    use_presimulation = True\n",
    "    presimulation_path = 'data/presimulations_froehlich_sde'\n",
    "    \n",
    "elif model_name == 'pharmacokinetic_model':\n",
    "    from models.pharmacokinetic_model import PharmacokineticModel\n",
    "    model = PharmacokineticModel(load_best=True)\n",
    "    \n",
    "    use_presimulation = True\n",
    "    presimulation_path = 'data/presimulations_pharma'\n",
    "elif model_name == 'clairon_model':\n",
    "    from models.clairon_model import ClaironModel\n",
    "    model = ClaironModel(load_best=True)\n",
    "\n",
    "    use_presimulation = True\n",
    "    presimulation_path = 'data/presimulations_clairon'\n",
    "elif model_name == 'clairon_small_model':\n",
    "    from models.clairon_small_model import ClaironSmallModel\n",
    "    model = ClaironSmallModel(load_best=True)\n",
    "\n",
    "    use_presimulation = True\n",
    "    presimulation_path = 'data/presimulations_small_clairon'\n",
    "else:\n",
    "    raise NotImplementedError('model not implemented')\n",
    "\n",
    "path_store_network = 'networks/' + model.network_name\n",
    "\n",
    "# assemble simulator and prior\n",
    "simulator = model.build_simulator()\n",
    "trainer = model.build_trainer(path_store_network)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "outputs": [],
   "source": [
    "model.print_and_plot_example()"
   ],
   "metadata": {
    "collapsed": false
   },
   "id": "6a1625b7a283db34"
  },
  {
   "cell_type": "markdown",
   "id": "6e26e6a9",
   "metadata": {},
   "source": [
    "## Estimating Population Parameters\n",
    "\n",
    "Now we want to use the amortizer to generate samples such that we can minimize the negative log-likelihood of the data given the population parameters of the mixed effect model:\n",
    "$$\n",
    "    \\beta^*,\\Psi^* \\approx \n",
    "    \\underset{\\beta,\\Psi}{\\arg\\min} -\\sum_i \\log\\left( \\frac1M \\sum_j^M \\frac{p(\\phi_j \\mid \\beta,\\Psi)}{p(\\phi_j)} \\right).\n",
    "$$\n",
    "\n",
    "Remark: the objective value is not the likelihood value since the sum over $\\log p(y_i)$ is missing.\n",
    "One part of the objective function increases logarithmically with the sample size $M$.\n",
    "On the other hand, the approximation gets better (therby decreasing the value?!)\n",
    "\n",
    "$\\beta$ is called ```theta_population``` in the code.\n",
    "\n",
    "\n",
    "$\\log \\phi$ cell specific parameters, sampled from $\\mathcal{N}(\\beta,\\Psi)$\n",
    "$$\n",
    "    p( \\phi \\mid \\beta,\\Psi) = (2\\pi)^{-k/2}\\vert \\Psi\\vert^{-1/2} \\prod_{l=1}^k \\phi_l^{-1} \\exp \\left(-\\frac12 (\\log \\phi-\\beta)^T \\Psi^{-1}  (\\log \\phi-\\beta) \\right)\n",
    "$$\n",
    "\n",
    "Assumptions to start with: $\\Psi$ is a diagonal matrix, need better parameterization for other types\n",
    "\n",
    "$$\n",
    "    \\beta^*,\\Psi^* \\approx\n",
    "    \\underset{\\beta,\\Psi}{\\arg\\min} -\\sum_i \\left(\\log \\frac1M \\sum_j^M \\frac{p( \\phi_j \\mid \\beta,\\Psi)}{p( \\phi_j)} \\right) \\\\\n",
    "     =  \\underset{\\beta,\\Psi}{\\arg\\min} -\\sum_i \\left(\\log\\left(\\vert \\Psi\\vert^{-1/2} \\right) -\\log M -\n",
    "    \\log\\left(\\vert \\Sigma\\vert^{-1/2}\\right) +\\log \\sum_j^M \\exp \\left(-\\frac12 (\\log\\phi_j-\\beta)^T \\Psi^{-1}  (\\log\\phi_j-\\beta) + \\frac12 (\\log\\phi_j-\\mu)^T \\Sigma^{-1}  (\\log\\phi_j-\\mu) \\right)\\right)\n",
    "$$\n",
    "\n",
    "if the prior is $p( \\phi) = (2\\pi)^{-k/2}\\vert \\Sigma\\vert^{-1/2} \\prod_{l=1}^k \\phi_l^{-1}\\exp \\left(-\\frac12 (\\log \\phi-\\mu)^T \\Sigma^{-1}  (\\log\\phi-\\mu) \\right)$.\n",
    "\n",
    "\n",
    "For purpose of optimization we also parametrize $\\Psi$ by a log-transformation since diagonal entries must be positive."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "eeee0f98",
   "metadata": {},
   "source": [
    "# Define Objective Function"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "outputs": [],
   "source": [
    "use_covariates = False\n",
    "\n",
    "if 'fröhlich' in model_name:\n",
    "    prior_std = model.prior_std\n",
    "    prior_mean = model.prior_mean\n",
    "    param_names = model.param_names\n",
    "elif 'clairon' in model_name:\n",
    "    prior_std = model.prior_std\n",
    "    prior_mean = model.prior_mean\n",
    "    param_names = model.param_names \n",
    "    if use_covariates:\n",
    "        param_names += ['c_age', 'c_gender']\n",
    "    \n",
    "    from models.clairon_model import batch_simulator, convert_to_observables\n",
    "elif 'pharmacokinetic_model' == model_name:\n",
    "    prior_std = model.prior_std[[0,1,2,3,4,5,6,7,8,9,10,11,12,13,16]]\n",
    "    prior_mean = model.prior_mean[[0,1,2,3,4,5,6,7,8,9,10,11,12,13,16]]\n",
    "    param_names = model.param_names[:14] + model.param_names[16:]\n",
    "else:\n",
    "    raise NotImplementedError('model not implemented')"
   ],
   "metadata": {
    "collapsed": false
   },
   "id": "23617593538cd87d"
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "outputs": [],
   "source": [
    "# for huber loss\n",
    "# 1.5 times the median of the posterior standard deviations\n",
    "#samples_sigma = np.median(model.draw_posterior_samples(data=obs_data, n_samples=1000)[:, :, -1])\n",
    "#huber_loss = np.exp(samples_sigma)*1.5\n",
    "huber_loss = None\n",
    "print(huber_loss)"
   ],
   "metadata": {
    "collapsed": false
   },
   "id": "39d115a8b7f1a997"
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "outputs": [],
   "source": [
    "cov_type = ['diag', 'cholesky'][0]\n",
    "\n",
    "if use_covariates and 'clairon' in model_name:\n",
    "    #simulator_noise_free = model.build_simulator(with_noise=False)\n",
    "    data, covariates = model.load_data(n_data=50, load_covariates=True)\n",
    "    def covariate_mapping(param_samples, covariates, params, tres=0.001):\n",
    "        additive_cov = np.sum(params[-2:]*covariates, axis=1)\n",
    "        #multiplicative_cov = np.sum(np.exp(params[-2:])*covariates, axis=1)\n",
    "        transformed_param_samples = np.exp(param_samples)\n",
    "        for s_id in range(transformed_param_samples.shape[0]):\n",
    "            transformed_param_samples[s_id, :, 0] -= additive_cov[s_id]  # cov on one parameter\n",
    "            #transformed_param_samples[s_id, :, 0] /= multiplicative_cov[s_id]\n",
    "\n",
    "\n",
    "            #_, t_measurements, dose_amount, doses_time_points = convert_to_observables(data[s_id])\n",
    "            #median_param = np.median(param_samples[s_id], axis=0)\n",
    "            #sim = batch_simulator(median_param[np.newaxis],\n",
    "            #                            t_measurements=t_measurements,\n",
    "            #                            dose_amount=dose_amount,\n",
    "            #                            t_doses=doses_time_points)\n",
    "            #y, _, _, _ = convert_to_observables(sim[0])\n",
    "            #transformed_param_samples[s_id, :, -4] -= np.exp(params[-4]) + np.exp(params[-3])*np.median(y)\n",
    "\n",
    "        transformed_param_samples[transformed_param_samples < 0] = tres\n",
    "\n",
    "        # append parameters of covariances, which are (log) normal with mean beta\n",
    "        param_samples_cov = np.concatenate((np.log(transformed_param_samples),\n",
    "                                            np.ones((transformed_param_samples.shape[0],transformed_param_samples.shape[1], 2))*params[-2:]),\n",
    "                                           axis=2)\n",
    "        return param_samples_cov\n",
    "    param_dim = len(param_names)\n",
    "else:\n",
    "    covariate_mapping = None\n",
    "    covariates = None\n",
    "    param_dim = None\n",
    "\n",
    "obj_fun_amortized = ObjectiveFunctionNLME(model_name=model.name,\n",
    "                                              param_samples=np.empty((1,1,1)),\n",
    "                                              prior_mean=prior_mean,\n",
    "                                              prior_std=prior_std,\n",
    "                                              covariance_format=cov_type,\n",
    "                                              covariates=covariates,\n",
    "                                              covariate_mapping=covariate_mapping,\n",
    "                                              param_dim=param_dim,\n",
    "                                              # np.exp(-3.41) * 1.5\n",
    "                                              penalize_correlations=None,\n",
    "                                              huber_loss_delta=huber_loss)"
   ],
   "metadata": {
    "collapsed": false
   },
   "id": "e20e10a5c8a8d7ed"
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "outputs": [],
   "source": [
    "pop_param_names = ['pop-' + name for name in param_names]\n",
    "var_param_names = ['var-' + name for name in param_names]\n",
    "full_param_names = pop_param_names + var_param_names\n",
    "\n",
    "if cov_type == 'cholesky' and len(full_param_names) == len(param_names)*2:\n",
    "    # add  correlation names to full parameter names\n",
    "    # make all possible combinations of parameter names\n",
    "    combinations = list(itertools.combinations(param_names, 2))\n",
    "    # create upper triangular matrix of parameter names\n",
    "    psi_inverse_upper = np.chararray((len(param_names), len(param_names)), itemsize=100, unicode=True)\n",
    "    psi_inverse_upper[np.diag_indices(len(param_names))] = \"1\"\n",
    "    psi_inverse_upper[np.triu_indices(len(param_names), k=1)] = [f\"corr_{x}_{y}\" for x, y in combinations]\n",
    "    # extract lower triangular matrix of parameter names, so that they are ordered as in the covariance matrix\n",
    "    corr_names = list(psi_inverse_upper.T[np.tril_indices(len(param_names), k=-1)])\n",
    "    # add correlation names to full parameter names\n",
    "    full_param_names = full_param_names + corr_names\n",
    "    print(full_param_names)"
   ],
   "metadata": {
    "collapsed": false
   },
   "id": "5417beb3c5989773"
  },
  {
   "cell_type": "markdown",
   "source": [
    "# Load Data"
   ],
   "metadata": {
    "collapsed": false
   },
   "id": "16d27137fea0b262"
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "outputs": [],
   "source": [
    "# define how many data points are used for optimization\n",
    "n_data = 1000 # 50\n",
    "load_real_data = True\n",
    "# load data\n",
    "if 'fröhlich' in model_name:\n",
    "    obs_data, true_pop_parameters = model.load_data(n_data=n_data, load_eGFP=load_real_data, load_d2eGFP=False)\n",
    "    \n",
    "    # load SDE data for comparison\n",
    "    #from models.froehlich_model_sde import FroehlichModelSDE\n",
    "    #model_sde = FroehlichModelSDE(load_best=True)\n",
    "    #obs_data, true_pop_parameters_sde = model_sde.load_data(n_data=n_data, load_eGFP=load_real_data, load_d2eGFP=False)\n",
    "    #true_pop_parameters = None\n",
    "else:\n",
    "    obs_data = model.load_data(n_data=n_data)\n",
    "    true_pop_parameters = None\n",
    "results_to_compare = None"
   ],
   "metadata": {
    "collapsed": false
   },
   "id": "41af9969686eb2e2"
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "outputs": [],
   "source": [
    "if not load_real_data:\n",
    "    if model_name == 'fröhlich-small':\n",
    "        path = f'output/results_monolix/small_model/estimated_parameters_synthetic_{n_data}_cells.csv'\n",
    "        results_monolix = pd.read_csv(path, index_col=0, header=0)\n",
    "        results_to_compare = results_monolix[results_monolix.columns[0]].values[[0, 1, 2, 3, 4, 10, 5, 6, 7, 8, 9]]\n",
    "        results_to_compare[5] = np.log(results_to_compare[5])  # sigma to log\n",
    "        results_to_compare = np.concatenate((results_to_compare, [0]))[np.newaxis, :]\n",
    "    elif model_name == 'fröhlich-large':\n",
    "        path = f'output/results_monolix/large_model/synthetic_{n_data}_poppars.csv'\n",
    "        results_monolix = pd.read_csv(path, index_col=0, header=0)\n",
    "        results_to_compare = results_monolix[results_monolix.columns[0]].values[[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 20,\n",
    "                                                                                 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]]\n",
    "        results_to_compare[10] = np.log(results_to_compare[10])  # sigma to log\n",
    "        results_to_compare = np.concatenate((results_to_compare, [0]))[np.newaxis, :]\n",
    "    elif model_name == 'fröhlich-sde':\n",
    "        pass\n",
    "\n",
    "if model_name == 'pharmacokinetic_model':\n",
    "    raw_nonmem_data = pd.read_csv(f'output/results_nonmem/retries_sunitinib_lognor.csv', delimiter=',',\n",
    "                           index_col=0, header=0)\n",
    "    # remove uninformative columns and add missing columns\n",
    "    raw_nonmem_data = raw_nonmem_data[raw_nonmem_data.columns[[0,1,3,4,5,6,7,9,11,12]+[13,15,18,22]+[14,16,17,19,20,21]+[25,39,40]]]\n",
    "    raw_nonmem_data.sort_values(by=['ofv'], inplace=True)\n",
    "\n",
    "    # remove uninformative columns and add missing columns\n",
    "    corr_names_nonmem = ['eta_1_eta_0', 'eta_2_eta_0', 'eta_2_eta_1', 'eta_3_eta_0', 'eta_3_eta_1', 'eta_3_eta_2']\n",
    "    raw_nonmem_data.columns = full_param_names[:10] + full_param_names[25:29] + corr_names_nonmem + list(raw_nonmem_data.columns[-3:])\n",
    "    # log transform population parameters\n",
    "    raw_nonmem_data[full_param_names[:10]] = raw_nonmem_data[full_param_names[:10]].abs().apply(np.log)\n",
    "    # add variances\n",
    "    raw_nonmem_data[full_param_names[10:25]] = np.zeros(15)\n",
    "    raw_nonmem_data[full_param_names[29]] = 0\n",
    "    # get results to compare\n",
    "    results_to_compare = raw_nonmem_data[full_param_names[:30]+corr_names_nonmem].values\n",
    "\n",
    "if cov_type == 'cholesky':\n",
    "    n_corr = len(param_names) * (len(param_names)-1) // 2\n",
    "    if true_pop_parameters is not None:\n",
    "        # add 0 correlations to true population parameters\n",
    "        true_pop_parameters = np.concatenate((true_pop_parameters, np.zeros(n_corr)), axis=0)\n",
    "    if results_to_compare is not None:\n",
    "        # add 0 correlations to results to compare\n",
    "        # not true for pharmacokinetic model\n",
    "        if model_name != 'pharmacokinetic_model':\n",
    "           results_to_compare = np.concatenate((results_to_compare, np.nan*np.ones((results_to_compare.shape[0], n_corr))), axis=1)"
   ],
   "metadata": {
    "collapsed": false
   },
   "id": "a75bd8d020c92a6"
  },
  {
   "cell_type": "markdown",
   "source": [
    "# Analyse correlations between parameters"
   ],
   "metadata": {
    "collapsed": false
   },
   "id": "54ebfa71aac1a925"
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "outputs": [],
   "source": [
    "param_samples = model.draw_posterior_samples(data=obs_data, n_samples=1000)\n",
    "param_median = np.median(param_samples, axis=1)\n",
    "# correlations without sigma\n",
    "median_df = pd.DataFrame(param_median[:, :-1], columns=model.param_names[:-1])\n",
    "corr_df = median_df.corr()"
   ],
   "metadata": {
    "collapsed": false
   },
   "id": "de47356800882bb0"
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "outputs": [],
   "source": [
    "print('Correlation Matrix from Median')\n",
    "corrplot(corr_df, size_scale=300)"
   ],
   "metadata": {
    "collapsed": false
   },
   "id": "f2b64a28627b2025"
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "outputs": [],
   "source": [
    "if cov_type == 'cholesky':\n",
    "    # Find pairs with correlation above the threshold\n",
    "    threshold = 0\n",
    "    abs_corr_matrix = corr_df.abs()\n",
    "    high_corr_pairs = abs_corr_matrix[abs_corr_matrix > threshold].unstack()\n",
    "    #high_corr_pairs = high_corr_pairs[high_corr_pairs['level_0'] != high_corr_pairs['level_1']]\n",
    "    high_corr_pairs = high_corr_pairs[high_corr_pairs < 1].sort_values(ascending=False)\n",
    "\n",
    "    # find indices corresponding to pairs with high correlations\n",
    "    high_corr_pairs_index = []\n",
    "    high_corr_pairs_names = []\n",
    "    for x,y in high_corr_pairs.index:\n",
    "        name = f'corr_{x}_{y}'\n",
    "        high_corr_pairs_index += [p_i for p_i, p_name in enumerate(full_param_names) if name == p_name]\n",
    "        high_corr_pairs_names += [p_name for p_i, p_name in enumerate(full_param_names) if name == p_name]\n",
    "    print(high_corr_pairs_names, len(high_corr_pairs_index))"
   ],
   "metadata": {
    "collapsed": false
   },
   "id": "9453ae34cf3add58"
  },
  {
   "cell_type": "markdown",
   "id": "ef7bec09",
   "metadata": {},
   "source": [
    "# Optimization (Single Experiment)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "outputs": [],
   "source": [
    "# create boundaries\n",
    "lower_bound, upper_bound = create_boundaries_from_prior(\n",
    "        prior_mean=prior_mean,\n",
    "        prior_std=prior_std,\n",
    "        boundary_width_from_prior=2.58,  # 99% of the prior mass is within 2.58 standard deviations\n",
    "        n_covariates=obj_fun_amortized.n_covariates,\n",
    "        covariates_bound=(1, 10),\n",
    "        covariance_format=cov_type\n",
    ")\n",
    "\n",
    "# sigma variance is always fixed\n",
    "index_sigma = [ix for ix, x in enumerate(full_param_names) if 'var-$\\\\sigma$' == x] + [ix for ix, x in enumerate(full_param_names) if 'var-std_error' == x]\n",
    "fixed_indices = np.array(index_sigma)  # variance of sigma fixed\n",
    "fixed_vals = np.array([upper_bound[index_sigma[0]]])\n",
    "\n",
    "if model_name == 'pharmacokinetic_model':\n",
    "    # fix mean of random parameters\n",
    "    eta_fix_idx = [10,11,12,13] # fix eta means to log(1)\n",
    "    eta_fix_value = [0] * len(eta_fix_idx)\n",
    "    # fix variance of fixed parameters\n",
    "    index_thetas = [ix for ix, x in enumerate(full_param_names) if 'theta' in x and 'var' in x]\n",
    "    theta_var_fix_value = list(upper_bound[index_thetas])\n",
    "    fixed_indices = np.array(eta_fix_idx + list(fixed_indices) + index_thetas)\n",
    "    fixed_vals = np.array(eta_fix_value + list(fixed_vals) + theta_var_fix_value)\n",
    "    # fix sigma like in nonmem\n",
    "    #index_sigma = [ix for ix, x in enumerate(full_param_names) if '\\\\sigma$' in x]\n",
    "    #fixed_indices = np.append(fixed_indices, index_sigma)\n",
    "    #fixed_vals = np.append(fixed_vals, [0])  # log value of 1\n",
    "    if cov_type == 'cholesky':\n",
    "        index_theta_corr = [ix for ix, x in enumerate(full_param_names) if 'theta' in x and 'corr' in x]\n",
    "        fixed_indices = np.append(fixed_indices, index_theta_corr)\n",
    "        fixed_vals = np.append(fixed_vals, np.zeros(len(index_theta_corr)))\n",
    "\n",
    "        # fix eta correlations like in nonmem\n",
    "        #fix_nonmem = ['corr_$\\\\eta_0$_$\\\\eta_2$','corr_$\\\\eta_0$_$\\\\eta_3$','corr_$\\\\eta_1$_$\\\\eta_3$']\n",
    "        #index_nonmem = [ix for ix, x in enumerate(full_param_names) if x in fix_nonmem]\n",
    "        #fixed_indices = np.append(fixed_indices, index_nonmem)\n",
    "        #fixed_vals = np.append(fixed_vals, [0] * len(index_nonmem))\n",
    "\n",
    "elif model_name == 'clairon_model':\n",
    "    index_var_covariates = [ix for ix, x in enumerate(full_param_names) if 'var-c_' in x]\n",
    "    fixed_indices = np.append(fixed_indices, index_var_covariates)\n",
    "    fixed_vals = np.append(fixed_vals, upper_bound[index_var_covariates])\n",
    "\n",
    "only_allow_high_corr = True\n",
    "if cov_type == 'cholesky':\n",
    "    if only_allow_high_corr:\n",
    "        # fix all correlations to 0 but high correlated ones\n",
    "        index_all_corr = [ix for ix, x in enumerate(full_param_names) if 'corr' in x]\n",
    "        # remove high_corr_pairs_index from index_all_corr\n",
    "        index_all_corr = [ix for ix in index_all_corr if ix not in high_corr_pairs_index]\n",
    "        fixed_indices = np.append(fixed_indices, index_all_corr)\n",
    "        fixed_vals = np.append(fixed_vals, np.zeros(len(index_all_corr)))\n",
    "\n",
    "\n",
    "# fix all correlations with sigma to 0\n",
    "index_sigma_corr = [ix for ix, x in enumerate(full_param_names) if 'sigma' in x and 'corr' in x]\n",
    "fixed_indices = np.append(fixed_indices, index_sigma_corr)\n",
    "fixed_vals = np.append(fixed_vals, np.zeros(len(index_sigma_corr)))"
   ],
   "metadata": {
    "collapsed": false
   },
   "id": "c478326d93d718b7"
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "outputs": [],
   "source": [
    "#index_offset = [ix for ix, x in enumerate(full_param_names) if '_offset' in x]\n",
    "#fixed_indices = np.append(fixed_indices, np.array(index_offset))\n",
    "#fixed_vals = np.append(fixed_vals, np.zeros(len(index_offset)))"
   ],
   "metadata": {
    "collapsed": false
   },
   "id": "ff5bf56dcd521062"
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "outputs": [],
   "source": [
    "#index_offset = [ix for ix, x in enumerate(full_param_names) if 'offset' in x and 'pop' not in x]\n",
    "#index_scale = [ix for ix, x in enumerate(full_param_names) if 'scale' in x and 'pop' not in x]\n",
    "#\n",
    "#fixed_indices = np.append(fixed_indices, index_offset+index_scale)  # fix offset and scale\n",
    "#fixed_vals = np.append(fixed_vals, upper_bound[index_offset+index_scale])"
   ],
   "metadata": {
    "collapsed": false
   },
   "id": "bd2af9400e65dbb4"
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "outputs": [],
   "source": [
    "# make sure that fixed indices are unique\n",
    "fixed_indices, unique_indices = np.unique(fixed_indices, return_index=True)\n",
    "fixed_vals = fixed_vals[unique_indices]"
   ],
   "metadata": {
    "collapsed": false
   },
   "id": "7489aee65495bd58"
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "outputs": [],
   "source": [
    "if model_name == 'pharmacokinetic_model':\n",
    "    draw_posterior_samples = lambda data, n_samples: model.draw_posterior_samples(data=data,\n",
    "                                                                                  n_samples=n_samples)[:, :,\n",
    "                                                     [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 16]]\n",
    "else:\n",
    "    draw_posterior_samples = model.draw_posterior_samples"
   ],
   "metadata": {
    "collapsed": false
   },
   "id": "cce784ab0b7c9e34"
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "outputs": [],
   "source": [
    "# remove nan values\n",
    "obs_data[np.isnan(obs_data)] = 700"
   ],
   "metadata": {
    "collapsed": false
   },
   "id": "5fb097dbe17434e8"
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "89a717d4",
   "metadata": {},
   "outputs": [],
   "source": [
    "%%time\n",
    "result_optimization = run_population_optimization(\n",
    "    bf_amortizer=model.amortizer,\n",
    "    data=obs_data,\n",
    "    param_names=full_param_names,\n",
    "    objective_function=obj_fun_amortized,\n",
    "    sample_posterior=draw_posterior_samples,\n",
    "    n_multi_starts=20,\n",
    "    noise_on_start_param=1,\n",
    "    n_samples_opt=50,\n",
    "    lb=lower_bound,\n",
    "    ub=upper_bound,\n",
    "    x_fixed_indices=fixed_indices,\n",
    "    x_fixed_vals=fixed_vals,\n",
    "    file_name=None, #'output/real_data/fröhlich_large_diag_new.h5', #f'output/sde-comparison/{model.name}_cells_{n_data}.hd5', #'fröhlich-small-corr-full-50cells-50samples.h5', #'Auto', #f\"{model_name}-synthetic.h5\",\n",
    "    verbose=True,\n",
    "    trace_record=True,\n",
    "    #pesto_optimizer=optimize.ScipyOptimizer(),\n",
    "    pesto_multi_processes=10,\n",
    "    result=None #result_optimization\n",
    "    )\n",
    "\n",
    "results = result_optimization.optimize_result.as_dataframe()['x']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "outputs": [],
   "source": [
    "#from pypesto.store import OptimizationResultHDF5Writer\n",
    "#writer = OptimizationResultHDF5Writer(f'output/{model_name}_real_{n_data}_3.hdf5')\n",
    "#writer.write(result_optimization)"
   ],
   "metadata": {
    "collapsed": false
   },
   "id": "df31875bcb4c3bc8"
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "outputs": [],
   "source": [
    "#from pypesto.store import OptimizationResultHDF5Reader\n",
    "#result_optimization2 = OptimizationResultHDF5Reader(f'output/scalability/{model.name}_cells_{n_data}_samples_{50}.hd5').read()\n",
    "#results = result_optimization.optimize_result.as_dataframe()['x']"
   ],
   "metadata": {
    "collapsed": false
   },
   "id": "33111933a42d448"
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e7d40875",
   "metadata": {
    "scrolled": false
   },
   "outputs": [],
   "source": [
    "visualize_pesto_result(result_optimization)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "fe7f9e00",
   "metadata": {},
   "outputs": [],
   "source": [
    "if true_pop_parameters is not None:\n",
    "    print('true values of log-normal distribution')\n",
    "    df_param_sample = pd.DataFrame(true_pop_parameters[np.newaxis,:].round(4),\n",
    "                               columns=full_param_names)\n",
    "    display(df_param_sample)\n",
    "\n",
    "if results_to_compare is not None:\n",
    "    print('values of baseline method of log-normal distribution')\n",
    "    df_param_sample = pd.DataFrame(results_to_compare, columns=full_param_names)\n",
    "    display(df_param_sample)\n",
    "\n",
    "print('estimated values of log-normal distribution')\n",
    "results_transformed = transform_pesto_results(results, len(param_names), cov_type=cov_type)\n",
    "df_param_sample = pd.DataFrame(results_transformed, columns=full_param_names)\n",
    "display(df_param_sample)\n",
    "#df_param_sample.to_csv(f'output/estimated_parameters_{model_name}_{n_data}.csv')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "outputs": [],
   "source": [
    "estimated_beta = results[0][:len(param_names)]\n",
    "estimated_psi = obj_fun_amortized.get_covariance(results[0][len(param_names):])"
   ],
   "metadata": {
    "collapsed": false
   },
   "id": "db8e9ba25a8e9372"
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "outputs": [],
   "source": [
    "display(estimated_beta)"
   ],
   "metadata": {
    "collapsed": false
   },
   "id": "5773f358a15668db"
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "outputs": [],
   "source": [
    "display(estimated_psi.diagonal())"
   ],
   "metadata": {
    "collapsed": false
   },
   "id": "e22cc62cc813fd7"
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "outputs": [],
   "source": [
    "simulator = model.build_simulator(with_noise=True)"
   ],
   "metadata": {
    "collapsed": false
   },
   "id": "29f49a68782130b3"
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d875e9ee",
   "metadata": {},
   "outputs": [],
   "source": [
    "if 'fröhlich' in model_name:\n",
    "    plot_real_vs_synthetic(estimated_mean=estimated_beta,\n",
    "                           estimated_cov=estimated_psi,\n",
    "                           data=obs_data,\n",
    "                           model_name=model.name,\n",
    "                           n_trajectories=len(obs_data),\n",
    "                           simulator=simulator,\n",
    "                           #save_fig='dif_ode', #model_name+'_eGFP_dif' if load_real_data else model_name+'_synthetic_dif',\n",
    "                           #estimation_function=np.median,\n",
    "                           ylim=(-1.,1.),\n",
    "                           seed=0)\n",
    "    plot_real_and_estimated(estimated_mean=estimated_beta,\n",
    "                           estimated_cov=estimated_psi,\n",
    "                           data=obs_data,\n",
    "                           model_name=model.name,\n",
    "                           n_trajectories=len(obs_data),\n",
    "                           simulator=simulator,\n",
    "                           #save_fig=model_name+'_eGFP_estimate' if load_real_data else model_name+'_synthetic_estimate',\n",
    "                           seed=0)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "28dc461f",
   "metadata": {},
   "outputs": [],
   "source": [
    "plot_parameter_estimates(results_transformed,\n",
    "                         param_names_plot=full_param_names,\n",
    "                         prior_mean=prior_mean,\n",
    "                         prior_std=prior_std,\n",
    "                         true_parameters=true_pop_parameters,\n",
    "                         save_fig=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3fcfe5d6",
   "metadata": {},
   "outputs": [],
   "source": [
    "plot_estimated_distributions(results_transformed[0],\n",
    "                             param_names_plot=param_names,\n",
    "                             prior_mean=prior_mean,\n",
    "                             prior_std=prior_std,\n",
    "                             true_parameters=true_pop_parameters,\n",
    "                             save_fig=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b5521063",
   "metadata": {},
   "outputs": [],
   "source": [
    "if results_to_compare is not None:\n",
    "    compare_list = [results_transformed[0], results_to_compare[0]]\n",
    "    plot_parameter_estimates(compare_list, param_names_plot=full_param_names,\n",
    "                         prior_mean=model.prior_mean,\n",
    "                         prior_std=model.prior_std,\n",
    "                         true_parameters=true_pop_parameters,\n",
    "                         run_names=['BayesFlow', 'Baseline'],\n",
    "                         save_fig=False)\n",
    "\n",
    "    print('Baseline Estimated Parameters')\n",
    "    plot_parameter_estimates(results_to_compare, param_names_plot=full_param_names,\n",
    "                         prior_mean=model.prior_mean,\n",
    "                         prior_std=model.prior_std,\n",
    "                         save_fig=False)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "da70f2e8",
   "metadata": {},
   "source": [
    "# Uncertainty Analysis"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "a186fb11",
   "metadata": {},
   "source": [
    "Uncertainty based on profiles -> more accurate"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "846ca6f3",
   "metadata": {},
   "outputs": [],
   "source": [
    "profile_options = profile.ProfileOptions(\n",
    "    min_step_size=0.0005, #0.001\n",
    "    step_size_factor=1.1, #1.25\n",
    "    delta_ratio_max=0.05, #0.1\n",
    "    default_step_size=0.005, #0.01\n",
    "    ratio_min=0.01, #0.145\n",
    ")\n",
    "\n",
    "result_optimization = profile.parameter_profile(\n",
    "    problem=result_optimization.problem,\n",
    "    result=result_optimization,\n",
    "    optimizer=optimize.ScipyOptimizer(),\n",
    "    engine=engine.MultiProcessEngine(10),\n",
    "    #profile_index=np.array([0]),\n",
    "    #result_index=0, # index from which optimization result profiling should be started\n",
    "    profile_options=profile_options,\n",
    "    filename=f'output/uncertainty/{model.name}_cells_{n_data}_samples_{50}.hd5',\n",
    "    #overwrite=True\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "outputs": [],
   "source": [
    "import matplotlib\n",
    "\n",
    "matplotlib.rcdefaults()  # for resetting to defaults\n",
    "plt.rcParams.update({'font.size': 14,\n",
    "                     #'text.usetex': True,\n",
    "                     \"font.family\": \"serif\",\n",
    "                     \"font.serif\": [\"Computer Modern Roman\"],\n",
    "                     'axes.titlesize': 'small',\n",
    "                     'axes.labelsize': 'small',\n",
    "                     'xtick.labelsize': 'xx-small', # todo: change back to small\n",
    "                     'ytick.labelsize': 'small',\n",
    "                     'legend.fontsize': 'small',\n",
    "                     #'figure.dpi': 600,\n",
    "                     'figure.figsize': (16,12)}) #\n",
    "colors = ['#1f78b4', '#a6cee3', '#b2df8a','#33a02c','#fb9a99']"
   ],
   "metadata": {
    "collapsed": false
   },
   "id": "ff1f595e405f9776"
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "786a1501",
   "metadata": {},
   "outputs": [],
   "source": [
    "ax = visualize.profiles(result_optimization, size=(16,12))\n",
    "#plt.savefig('plots/synthetic_profiles_small_stochastic_data.pdf', bbox_inches='tight', dpi=600, format='pdf')\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "02e078a3",
   "metadata": {},
   "outputs": [],
   "source": [
    "ax = visualize.profile_cis(result_optimization) #,\n",
    "                                  #profile_indices=[0,1,2,3,4,5,6,7,8,9,10,11])\n",
    "ax.set_title('Approximate Confidence Intervals \\n Based on Profiles')\n",
    "plt.tight_layout()\n",
    "#plt.savefig('plots/synthetic_FIM_profiles_cis.png')\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "outputs": [],
   "source": [
    "def plot_intervals(median, cis,\n",
    "                   ax=None, alpha=0.3,\n",
    "                   par_names: list = None,\n",
    "                   levels: list = [0.05, 0.95],\n",
    "                   offset: float = 0,\n",
    "                   color: str = None):\n",
    "    for i_par, par in enumerate(par_names):\n",
    "        for i_c, confidence in reversed(list(enumerate(levels))):\n",
    "            ax.hlines(i_par + offset,\n",
    "                      cis[i_par, i_c],\n",
    "                      cis[i_par, -1 - i_c],\n",
    "                      linewidth=8 / len(levels) * (len(levels) - i_c),\n",
    "                      alpha=1 / len(levels) * (len(levels) - i_c),\n",
    "                      color=color)\n",
    "            ax.vlines(median[i_par], offset + i_par - 0.15, offset + i_par + 0.15, color=\"black\", alpha=alpha)\n",
    "    xmin, xmax = ax.get_xlim()\n",
    "    for i_par, par in enumerate(par_names):\n",
    "        ax.hlines(i_par + 0.5, xmin, xmax, color=\"black\", linewidth=1, linestyle=\"dashed\", alpha=0.1)"
   ],
   "metadata": {
    "collapsed": false
   },
   "id": "ce8f4de04da2454b"
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "outputs": [],
   "source": [
    "if model_name == 'pharmacokinetic_model':\n",
    "    plt.scatter(np.arange(1, len(raw_data['ofv'])+1-15), -raw_data['ofv'][:-15])\n",
    "    plt.yscale('log')\n",
    "    plt.show()"
   ],
   "metadata": {
    "collapsed": false
   },
   "id": "e8c465280a3a6415"
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "outputs": [],
   "source": [
    "if model_name == 'pharmacokinetic_model':\n",
    "    x_names = [result_optimization.problem.x_names[ix] for ix in profile_indices]\n",
    "    x_names[11] = 'var $\\\\eta_0$'\n",
    "    x_names[12] = 'var $\\\\eta_1$'\n",
    "    x_names[13] = 'var $\\\\eta_2$'\n",
    "    x_names[14] = 'var $\\\\eta_3$'\n",
    "\n",
    "    n_results_compare = 100\n",
    "    results_compare_min = np.min(results_to_compare[:n_results_compare], axis=0)\n",
    "    results_compare_max = np.max(results_to_compare[:n_results_compare], axis=0)\n",
    "    intervals_compare = np.array([results_compare_min, results_compare_max]).T\n",
    "\n",
    "    baseline_params = [results_to_compare[0][ix] for ix in profile_indices]\n",
    "    intervals_compare_non_fixed = [intervals_compare[ix] for ix in profile_indices]\n",
    "\n",
    "    # wt and DOS are not removed from the prior\n",
    "    prior_mean_non_fixed = [model.prior_mean[ix] for ix in profile_indices if ix <= model.n_params]\n",
    "    prior_mean_non_fixed[-1] = model.prior_mean[14+2]\n",
    "    prior_std_non_fixed = np.array([model.prior_std[ix] for ix in profile_indices if ix <= model.n_params])\n",
    "    prior_std_non_fixed[-1] = model.prior_std[14+2]\n",
    "    prior_intervals = np.array([prior_mean_non_fixed - 1.96*prior_std_non_fixed,\n",
    "                                prior_mean_non_fixed + 1.96*prior_std_non_fixed]).T\n",
    "\n",
    "    plt.figure(figsize=(8,6))\n",
    "    plt.title('\\\\bf{C}', loc='left')\n",
    "    for y, (ci_l, ci_u) in enumerate(prior_intervals):\n",
    "        plt.plot([ci_l, ci_u], [y, y], linestyle='--', color='g', label='95\\% Prior-Region' if y == 0 else None)\n",
    "\n",
    "    for y, (l, u) in enumerate(intervals_compare_non_fixed):\n",
    "        if y < 11:\n",
    "            plt.plot([l, u], [y, y], marker='|', color='b', label=f'Range of Best Fits Baseline' if y == 0 else None)\n",
    "            plt.plot(baseline_params[y], y, marker='x', color='y', label='Optimal Fit Baseline' if y == 0 else None)\n",
    "        else:\n",
    "            # convert variance params\n",
    "            plt.plot([np.exp(-u), np.exp(-l)], [y, y], marker='|', color='b')\n",
    "            plt.plot(np.exp(-baseline_params[y]), y, marker='x', color='y')\n",
    "\n",
    "    for y, (ci_l, ci_u) in enumerate(intervals):\n",
    "        if y < 11:\n",
    "            plt.plot([ci_l, ci_u], [y, y], marker='|', color='r', label='CI Amortized NLME' if y == 0 else None)\n",
    "        else:\n",
    "            # convert variance params\n",
    "            plt.plot([np.exp(-ci_u), np.exp(-ci_l)], [y, y], marker='|', color='r')\n",
    "\n",
    "    #plt.xscale('symlog')\n",
    "    plt.yticks(ticks=np.arange(len(x_names)), labels=x_names)\n",
    "    plt.xlabel('Parameter Value')\n",
    "    plt.legend()\n",
    "    plt.show()"
   ],
   "metadata": {
    "collapsed": false
   },
   "id": "314ad43caa774f5d"
  },
  {
   "cell_type": "markdown",
   "id": "35ac88c2",
   "metadata": {},
   "source": [
    "Uncertainty based on FIM"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c6a4ae8c",
   "metadata": {},
   "outputs": [],
   "source": [
    "result_optimization = profile.approximate_parameter_profile(\n",
    "    problem=result_optimization.problem,\n",
    "    result=result_optimization,\n",
    "    #profile_index=np.array([1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]),\n",
    "    #result_index=0, # index from which optimization result profiling should be started\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "82a9ce00",
   "metadata": {},
   "outputs": [],
   "source": [
    "visualize.profiles(result_optimization)\n",
    "#plt.savefig('plots/synthetic_FIM_profiles.png')\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "outputs": [],
   "source": [
    "n_indv = obs_data.shape[0]\n",
    "confidence_ratio = profile.chi2_quantile_to_ratio(alpha=0.95, df=n_indv-(model.n_params*2))\n",
    "\n",
    "confidence_intervals = np.zeros((model.n_params*2, 2))\n",
    "\n",
    "for param_idx in range(model.n_params*2):\n",
    "    try:\n",
    "        xs = result_optimization.profile_result.list[0][param_idx]['x_path'][param_idx]\n",
    "        ratios = result_optimization.profile_result.list[0][0]['ratio_path']\n",
    "        confidence_intervals[param_idx] = profile.calculate_approximate_ci(xs, ratios,\n",
    "                                                                            confidence_ratio=confidence_ratio)\n",
    "    except TypeError:\n",
    "        print(f'for {full_param_names[param_idx]} confidence interval could not be estimated')\n",
    "\n",
    "confidence_intervals"
   ],
   "metadata": {
    "collapsed": false
   },
   "id": "c875c48b2d412283"
  },
  {
   "cell_type": "markdown",
   "source": [
    "# Emperical Bayes"
   ],
   "metadata": {
    "collapsed": false
   },
   "id": "37e911a5919df150"
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "outputs": [],
   "source": [
    "from functools import partial\n",
    "from pypesto import FD, Objective, Problem\n",
    "from multiprocess import Pool"
   ],
   "metadata": {
    "collapsed": false
   },
   "id": "972293f80c197939"
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "outputs": [],
   "source": [
    "obj_fun_amortized.precompute_pop_params(vector_params=results[0])\n",
    "# only population parameters without variance\n",
    "lower_bound = lower_bound[:model.n_params]\n",
    "upper_bound = upper_bound[:model.n_params]"
   ],
   "metadata": {
    "collapsed": false
   },
   "id": "de425753357d835a"
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "outputs": [],
   "source": [
    "def empirical_bayes(individual_params: np.ndarray,\n",
    "                    data: np.ndarray,\n",
    "                    obj_fun: ObjectiveFunctionNLME) -> float:\n",
    "    # plug individual parameters into loss function\n",
    "    conditional = obj_fun.empirical_bayes(individual_params=individual_params)\n",
    "    configured_sample = model.configured_input({'prior_draws': individual_params[np.newaxis, np.newaxis, :],\n",
    "                                                'sim_data': data[np.newaxis, :]})\n",
    "    posterior = model.amortizer.log_posterior(configured_sample).flatten()\n",
    "    bayes_obj = -float(posterior) + conditional\n",
    "    return bayes_obj"
   ],
   "metadata": {
    "collapsed": false
   },
   "id": "9af7083e545cd857"
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "outputs": [],
   "source": [
    "fixed_indices = [i for i, n in enumerate(param_names) if 'error' in n]\n",
    "fixed_values = results[0][fixed_indices]\n",
    "\n",
    "start_val = []  # for some reason cannot inside the multiprocessing function\n",
    "for patient_id in range(len(obs_data)):\n",
    "    real_posterior_draw = model.draw_posterior_samples(data=obs_data[patient_id][np.newaxis, :],\n",
    "                                                       n_samples=50)\n",
    "    start_val.append(np.median(real_posterior_draw, axis=0)[[i for i in range(len(param_names)) if i not in fixed_indices]])"
   ],
   "metadata": {
    "collapsed": false
   },
   "id": "f6c8b33959a392ce"
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "outputs": [],
   "source": [
    "def get_empirical_bayes(data_id: int, n_start: int = 1) -> np.ndarray:\n",
    "    pesto_objective = FD(obj=Objective(fun=partial(empirical_bayes,\n",
    "                                                   data=obs_data[data_id],\n",
    "                                                   obj_fun=obj_fun_amortized),\n",
    "                                       x_names=param_names))\n",
    "    pesto_problem = Problem(objective=pesto_objective,\n",
    "                            lb=lower_bound, ub=upper_bound,\n",
    "                            x_fixed_indices=fixed_indices,\n",
    "                            x_fixed_vals=fixed_values,\n",
    "                            x_names=param_names,\n",
    "                            x_scales=['log']*len(param_names),\n",
    "                            x_guesses=[start_val[data_id]])\n",
    "\n",
    "    result = optimize.minimize(\n",
    "        problem=pesto_problem,\n",
    "        optimizer=optimize.ScipyOptimizer(),\n",
    "        #engine=engine.MultiProcessEngine(10), # not working due to pickling\n",
    "        n_starts=n_start,\n",
    "        progress_bar=False)\n",
    "    return result.optimize_result.as_dataframe()"
   ],
   "metadata": {
    "collapsed": false,
    "ExecuteTime": {
     "end_time": "2023-08-14T16:31:01.673285Z",
     "start_time": "2023-08-14T16:31:01.656989Z"
    }
   },
   "id": "7645d0066ce63c40"
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n",
      "Some initial guesses supplied violate the bounds set for this problem.\n",
      "WARNING:pypesto.problem.base:Some initial guesses supplied violate the bounds set for this problem.\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Done\n",
      "CPU times: user 1.25 s, sys: 786 ms, total: 2.03 s\n",
      "Wall time: 1h 16min 49s\n"
     ]
    }
   ],
   "source": [
    "%%time\n",
    "if __name__ == '__main__':\n",
    "    with Pool(10) as mp_pool:\n",
    "        empirical_bayes_res_full = mp_pool.map(get_empirical_bayes, range(len(obs_data)))\n",
    "print('Done')"
   ],
   "metadata": {
    "collapsed": false,
    "ExecuteTime": {
     "end_time": "2023-08-14T17:47:51.332690Z",
     "start_time": "2023-08-14T16:31:02.180077Z"
    }
   },
   "id": "8d2f841b7397bf8f"
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "outputs": [],
   "source": [
    "bayes_results = [result_df['x'][0] for result_df in empirical_bayes_res_full]\n",
    "test_patients = obs_data[:len(bayes_results)]"
   ],
   "metadata": {
    "collapsed": false,
    "ExecuteTime": {
     "end_time": "2023-08-14T19:58:44.713849Z",
     "start_time": "2023-08-14T19:58:44.709364Z"
    }
   },
   "id": "fae10434a6a2a0f8"
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "outputs": [],
   "source": [
    "posterior_draws = model.draw_posterior_samples(data=test_patients, n_samples=100)"
   ],
   "metadata": {
    "collapsed": false,
    "ExecuteTime": {
     "end_time": "2023-08-14T19:58:46.510042Z",
     "start_time": "2023-08-14T19:58:45.712941Z"
    }
   },
   "id": "537c58031401ea42"
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "outputs": [
    {
     "ename": "KeyboardInterrupt",
     "evalue": "",
     "output_type": "error",
     "traceback": [
      "\u001B[0;31m---------------------------------------------------------------------------\u001B[0m",
      "\u001B[0;31mKeyboardInterrupt\u001B[0m                         Traceback (most recent call last)",
      "Cell \u001B[0;32mIn[35], line 33\u001B[0m\n\u001B[1;32m     30\u001B[0m     axis[p_id]\u001B[38;5;241m.\u001B[39mplot(t_measurements, np\u001B[38;5;241m.\u001B[39mmedian(y_full, axis\u001B[38;5;241m=\u001B[39m\u001B[38;5;241m0\u001B[39m), \u001B[38;5;124m'\u001B[39m\u001B[38;5;124mb\u001B[39m\u001B[38;5;124m'\u001B[39m)\n\u001B[1;32m     32\u001B[0m     y, t_measurements, _, _ \u001B[38;5;241m=\u001B[39m convert_to_observables(test_patients[p_id])\n\u001B[0;32m---> 33\u001B[0m     \u001B[43maxis\u001B[49m\u001B[43m[\u001B[49m\u001B[43mp_id\u001B[49m\u001B[43m]\u001B[49m\u001B[38;5;241;43m.\u001B[39;49m\u001B[43mscatter\u001B[49m\u001B[43m(\u001B[49m\u001B[43mt_measurements\u001B[49m\u001B[43m,\u001B[49m\u001B[43m \u001B[49m\u001B[43my\u001B[49m\u001B[43m,\u001B[49m\u001B[43m \u001B[49m\u001B[43mcolor\u001B[49m\u001B[38;5;241;43m=\u001B[39;49m\u001B[38;5;124;43m'\u001B[39;49m\u001B[38;5;124;43mg\u001B[39;49m\u001B[38;5;124;43m'\u001B[39;49m\u001B[43m)\u001B[49m\n\u001B[1;32m     35\u001B[0m median, \u001B[38;5;241m=\u001B[39m plt\u001B[38;5;241m.\u001B[39mplot([], [], color\u001B[38;5;241m=\u001B[39m\u001B[38;5;124m'\u001B[39m\u001B[38;5;124mb\u001B[39m\u001B[38;5;124m'\u001B[39m, label\u001B[38;5;241m=\u001B[39m\u001B[38;5;124m'\u001B[39m\u001B[38;5;124mposterior median\u001B[39m\u001B[38;5;124m'\u001B[39m)\n\u001B[1;32m     36\u001B[0m bayes, \u001B[38;5;241m=\u001B[39m plt\u001B[38;5;241m.\u001B[39mplot([], [], color\u001B[38;5;241m=\u001B[39m\u001B[38;5;124m'\u001B[39m\u001B[38;5;124mr\u001B[39m\u001B[38;5;124m'\u001B[39m, label\u001B[38;5;241m=\u001B[39m\u001B[38;5;124m'\u001B[39m\u001B[38;5;124memperical bayes estimate\u001B[39m\u001B[38;5;124m'\u001B[39m)\n",
      "File \u001B[0;32m~/miniconda/envs/AmortizedNLMEs/lib/python3.9/site-packages/matplotlib/__init__.py:1442\u001B[0m, in \u001B[0;36m_preprocess_data.<locals>.inner\u001B[0;34m(ax, data, *args, **kwargs)\u001B[0m\n\u001B[1;32m   1439\u001B[0m \u001B[38;5;129m@functools\u001B[39m\u001B[38;5;241m.\u001B[39mwraps(func)\n\u001B[1;32m   1440\u001B[0m \u001B[38;5;28;01mdef\u001B[39;00m \u001B[38;5;21minner\u001B[39m(ax, \u001B[38;5;241m*\u001B[39margs, data\u001B[38;5;241m=\u001B[39m\u001B[38;5;28;01mNone\u001B[39;00m, \u001B[38;5;241m*\u001B[39m\u001B[38;5;241m*\u001B[39mkwargs):\n\u001B[1;32m   1441\u001B[0m     \u001B[38;5;28;01mif\u001B[39;00m data \u001B[38;5;129;01mis\u001B[39;00m \u001B[38;5;28;01mNone\u001B[39;00m:\n\u001B[0;32m-> 1442\u001B[0m         \u001B[38;5;28;01mreturn\u001B[39;00m \u001B[43mfunc\u001B[49m\u001B[43m(\u001B[49m\u001B[43max\u001B[49m\u001B[43m,\u001B[49m\u001B[43m \u001B[49m\u001B[38;5;241;43m*\u001B[39;49m\u001B[38;5;28;43mmap\u001B[39;49m\u001B[43m(\u001B[49m\u001B[43msanitize_sequence\u001B[49m\u001B[43m,\u001B[49m\u001B[43m \u001B[49m\u001B[43margs\u001B[49m\u001B[43m)\u001B[49m\u001B[43m,\u001B[49m\u001B[43m \u001B[49m\u001B[38;5;241;43m*\u001B[39;49m\u001B[38;5;241;43m*\u001B[39;49m\u001B[43mkwargs\u001B[49m\u001B[43m)\u001B[49m\n\u001B[1;32m   1444\u001B[0m     bound \u001B[38;5;241m=\u001B[39m new_sig\u001B[38;5;241m.\u001B[39mbind(ax, \u001B[38;5;241m*\u001B[39margs, \u001B[38;5;241m*\u001B[39m\u001B[38;5;241m*\u001B[39mkwargs)\n\u001B[1;32m   1445\u001B[0m     auto_label \u001B[38;5;241m=\u001B[39m (bound\u001B[38;5;241m.\u001B[39marguments\u001B[38;5;241m.\u001B[39mget(label_namer)\n\u001B[1;32m   1446\u001B[0m                   \u001B[38;5;129;01mor\u001B[39;00m bound\u001B[38;5;241m.\u001B[39mkwargs\u001B[38;5;241m.\u001B[39mget(label_namer))\n",
      "File \u001B[0;32m~/miniconda/envs/AmortizedNLMEs/lib/python3.9/site-packages/matplotlib/axes/_axes.py:4711\u001B[0m, in \u001B[0;36mAxes.scatter\u001B[0;34m(self, x, y, s, c, marker, cmap, norm, vmin, vmax, alpha, linewidths, edgecolors, plotnonfinite, **kwargs)\u001B[0m\n\u001B[1;32m   4708\u001B[0m     \u001B[38;5;28;01mif\u001B[39;00m \u001B[38;5;28mself\u001B[39m\u001B[38;5;241m.\u001B[39m_ymargin \u001B[38;5;241m<\u001B[39m \u001B[38;5;241m0.05\u001B[39m \u001B[38;5;129;01mand\u001B[39;00m x\u001B[38;5;241m.\u001B[39msize \u001B[38;5;241m>\u001B[39m \u001B[38;5;241m0\u001B[39m:\n\u001B[1;32m   4709\u001B[0m         \u001B[38;5;28mself\u001B[39m\u001B[38;5;241m.\u001B[39mset_ymargin(\u001B[38;5;241m0.05\u001B[39m)\n\u001B[0;32m-> 4711\u001B[0m \u001B[38;5;28;43mself\u001B[39;49m\u001B[38;5;241;43m.\u001B[39;49m\u001B[43madd_collection\u001B[49m\u001B[43m(\u001B[49m\u001B[43mcollection\u001B[49m\u001B[43m)\u001B[49m\n\u001B[1;32m   4712\u001B[0m \u001B[38;5;28mself\u001B[39m\u001B[38;5;241m.\u001B[39m_request_autoscale_view()\n\u001B[1;32m   4714\u001B[0m \u001B[38;5;28;01mreturn\u001B[39;00m collection\n",
      "File \u001B[0;32m~/miniconda/envs/AmortizedNLMEs/lib/python3.9/site-packages/matplotlib/axes/_base.py:2263\u001B[0m, in \u001B[0;36m_AxesBase.add_collection\u001B[0;34m(self, collection, autolim)\u001B[0m\n\u001B[1;32m   2258\u001B[0m     collection\u001B[38;5;241m.\u001B[39mset_clip_path(\u001B[38;5;28mself\u001B[39m\u001B[38;5;241m.\u001B[39mpatch)\n\u001B[1;32m   2260\u001B[0m \u001B[38;5;28;01mif\u001B[39;00m autolim:\n\u001B[1;32m   2261\u001B[0m     \u001B[38;5;66;03m# Make sure viewLim is not stale (mostly to match\u001B[39;00m\n\u001B[1;32m   2262\u001B[0m     \u001B[38;5;66;03m# pre-lazy-autoscale behavior, which is not really better).\u001B[39;00m\n\u001B[0;32m-> 2263\u001B[0m     \u001B[38;5;28;43mself\u001B[39;49m\u001B[38;5;241;43m.\u001B[39;49m\u001B[43m_unstale_viewLim\u001B[49m\u001B[43m(\u001B[49m\u001B[43m)\u001B[49m\n\u001B[1;32m   2264\u001B[0m     datalim \u001B[38;5;241m=\u001B[39m collection\u001B[38;5;241m.\u001B[39mget_datalim(\u001B[38;5;28mself\u001B[39m\u001B[38;5;241m.\u001B[39mtransData)\n\u001B[1;32m   2265\u001B[0m     points \u001B[38;5;241m=\u001B[39m datalim\u001B[38;5;241m.\u001B[39mget_points()\n",
      "File \u001B[0;32m~/miniconda/envs/AmortizedNLMEs/lib/python3.9/site-packages/matplotlib/axes/_base.py:852\u001B[0m, in \u001B[0;36m_AxesBase._unstale_viewLim\u001B[0;34m(self)\u001B[0m\n\u001B[1;32m    850\u001B[0m     \u001B[38;5;28;01mfor\u001B[39;00m ax \u001B[38;5;129;01min\u001B[39;00m \u001B[38;5;28mself\u001B[39m\u001B[38;5;241m.\u001B[39m_shared_axes[name]\u001B[38;5;241m.\u001B[39mget_siblings(\u001B[38;5;28mself\u001B[39m):\n\u001B[1;32m    851\u001B[0m         ax\u001B[38;5;241m.\u001B[39m_stale_viewlims[name] \u001B[38;5;241m=\u001B[39m \u001B[38;5;28;01mFalse\u001B[39;00m\n\u001B[0;32m--> 852\u001B[0m \u001B[38;5;28;43mself\u001B[39;49m\u001B[38;5;241;43m.\u001B[39;49m\u001B[43mautoscale_view\u001B[49m\u001B[43m(\u001B[49m\u001B[38;5;241;43m*\u001B[39;49m\u001B[38;5;241;43m*\u001B[39;49m\u001B[43m{\u001B[49m\u001B[38;5;124;43mf\u001B[39;49m\u001B[38;5;124;43m\"\u001B[39;49m\u001B[38;5;124;43mscale\u001B[39;49m\u001B[38;5;132;43;01m{\u001B[39;49;00m\u001B[43mname\u001B[49m\u001B[38;5;132;43;01m}\u001B[39;49;00m\u001B[38;5;124;43m\"\u001B[39;49m\u001B[43m:\u001B[49m\u001B[43m \u001B[49m\u001B[43mscale\u001B[49m\n\u001B[1;32m    853\u001B[0m \u001B[43m                       \u001B[49m\u001B[38;5;28;43;01mfor\u001B[39;49;00m\u001B[43m \u001B[49m\u001B[43mname\u001B[49m\u001B[43m,\u001B[49m\u001B[43m \u001B[49m\u001B[43mscale\u001B[49m\u001B[43m \u001B[49m\u001B[38;5;129;43;01min\u001B[39;49;00m\u001B[43m \u001B[49m\u001B[43mneed_scale\u001B[49m\u001B[38;5;241;43m.\u001B[39;49m\u001B[43mitems\u001B[49m\u001B[43m(\u001B[49m\u001B[43m)\u001B[49m\u001B[43m}\u001B[49m\u001B[43m)\u001B[49m\n",
      "File \u001B[0;32m~/miniconda/envs/AmortizedNLMEs/lib/python3.9/site-packages/matplotlib/axes/_base.py:2930\u001B[0m, in \u001B[0;36m_AxesBase.autoscale_view\u001B[0;34m(self, tight, scalex, scaley)\u001B[0m\n\u001B[1;32m   2927\u001B[0m     set_bound(x0, x1)\n\u001B[1;32m   2928\u001B[0m     \u001B[38;5;66;03m# End of definition of internal function 'handle_single_axis'.\u001B[39;00m\n\u001B[0;32m-> 2930\u001B[0m \u001B[43mhandle_single_axis\u001B[49m\u001B[43m(\u001B[49m\n\u001B[1;32m   2931\u001B[0m \u001B[43m    \u001B[49m\u001B[43mscalex\u001B[49m\u001B[43m,\u001B[49m\u001B[43m \u001B[49m\u001B[38;5;28;43mself\u001B[39;49m\u001B[38;5;241;43m.\u001B[39;49m\u001B[43m_shared_axes\u001B[49m\u001B[43m[\u001B[49m\u001B[38;5;124;43m\"\u001B[39;49m\u001B[38;5;124;43mx\u001B[39;49m\u001B[38;5;124;43m\"\u001B[39;49m\u001B[43m]\u001B[49m\u001B[43m,\u001B[49m\u001B[43m \u001B[49m\u001B[38;5;124;43m'\u001B[39;49m\u001B[38;5;124;43mx\u001B[39;49m\u001B[38;5;124;43m'\u001B[39;49m\u001B[43m,\u001B[49m\u001B[43m \u001B[49m\u001B[38;5;28;43mself\u001B[39;49m\u001B[38;5;241;43m.\u001B[39;49m\u001B[43mxaxis\u001B[49m\u001B[43m,\u001B[49m\u001B[43m \u001B[49m\u001B[38;5;28;43mself\u001B[39;49m\u001B[38;5;241;43m.\u001B[39;49m\u001B[43m_xmargin\u001B[49m\u001B[43m,\u001B[49m\n\u001B[1;32m   2932\u001B[0m \u001B[43m    \u001B[49m\u001B[43mx_stickies\u001B[49m\u001B[43m,\u001B[49m\u001B[43m \u001B[49m\u001B[38;5;28;43mself\u001B[39;49m\u001B[38;5;241;43m.\u001B[39;49m\u001B[43mset_xbound\u001B[49m\u001B[43m)\u001B[49m\n\u001B[1;32m   2933\u001B[0m handle_single_axis(\n\u001B[1;32m   2934\u001B[0m     scaley, \u001B[38;5;28mself\u001B[39m\u001B[38;5;241m.\u001B[39m_shared_axes[\u001B[38;5;124m\"\u001B[39m\u001B[38;5;124my\u001B[39m\u001B[38;5;124m\"\u001B[39m], \u001B[38;5;124m'\u001B[39m\u001B[38;5;124my\u001B[39m\u001B[38;5;124m'\u001B[39m, \u001B[38;5;28mself\u001B[39m\u001B[38;5;241m.\u001B[39myaxis, \u001B[38;5;28mself\u001B[39m\u001B[38;5;241m.\u001B[39m_ymargin,\n\u001B[1;32m   2935\u001B[0m     y_stickies, \u001B[38;5;28mself\u001B[39m\u001B[38;5;241m.\u001B[39mset_ybound)\n",
      "File \u001B[0;32m~/miniconda/envs/AmortizedNLMEs/lib/python3.9/site-packages/matplotlib/axes/_base.py:2927\u001B[0m, in \u001B[0;36m_AxesBase.autoscale_view.<locals>.handle_single_axis\u001B[0;34m(scale, shared_axes, name, axis, margin, stickies, set_bound)\u001B[0m\n\u001B[1;32m   2925\u001B[0m \u001B[38;5;28;01mif\u001B[39;00m \u001B[38;5;129;01mnot\u001B[39;00m \u001B[38;5;28mself\u001B[39m\u001B[38;5;241m.\u001B[39m_tight:\n\u001B[1;32m   2926\u001B[0m     x0, x1 \u001B[38;5;241m=\u001B[39m locator\u001B[38;5;241m.\u001B[39mview_limits(x0, x1)\n\u001B[0;32m-> 2927\u001B[0m \u001B[43mset_bound\u001B[49m\u001B[43m(\u001B[49m\u001B[43mx0\u001B[49m\u001B[43m,\u001B[49m\u001B[43m \u001B[49m\u001B[43mx1\u001B[49m\u001B[43m)\u001B[49m\n",
      "File \u001B[0;32m~/miniconda/envs/AmortizedNLMEs/lib/python3.9/site-packages/matplotlib/axes/_base.py:3530\u001B[0m, in \u001B[0;36m_AxesBase.set_xbound\u001B[0;34m(self, lower, upper)\u001B[0m\n\u001B[1;32m   3527\u001B[0m \u001B[38;5;28;01mif\u001B[39;00m upper \u001B[38;5;129;01mis\u001B[39;00m \u001B[38;5;28;01mNone\u001B[39;00m:\n\u001B[1;32m   3528\u001B[0m     upper \u001B[38;5;241m=\u001B[39m old_upper\n\u001B[0;32m-> 3530\u001B[0m \u001B[38;5;28;43mself\u001B[39;49m\u001B[38;5;241;43m.\u001B[39;49m\u001B[43mset_xlim\u001B[49m\u001B[43m(\u001B[49m\u001B[38;5;28;43msorted\u001B[39;49m\u001B[43m(\u001B[49m\u001B[43m(\u001B[49m\u001B[43mlower\u001B[49m\u001B[43m,\u001B[49m\u001B[43m \u001B[49m\u001B[43mupper\u001B[49m\u001B[43m)\u001B[49m\u001B[43m,\u001B[49m\n\u001B[1;32m   3531\u001B[0m \u001B[43m                     \u001B[49m\u001B[43mreverse\u001B[49m\u001B[38;5;241;43m=\u001B[39;49m\u001B[38;5;28;43mbool\u001B[39;49m\u001B[43m(\u001B[49m\u001B[38;5;28;43mself\u001B[39;49m\u001B[38;5;241;43m.\u001B[39;49m\u001B[43mxaxis_inverted\u001B[49m\u001B[43m(\u001B[49m\u001B[43m)\u001B[49m\u001B[43m)\u001B[49m\u001B[43m)\u001B[49m\u001B[43m,\u001B[49m\n\u001B[1;32m   3532\u001B[0m \u001B[43m              \u001B[49m\u001B[43mauto\u001B[49m\u001B[38;5;241;43m=\u001B[39;49m\u001B[38;5;28;43;01mNone\u001B[39;49;00m\u001B[43m)\u001B[49m\n",
      "File \u001B[0;32m~/miniconda/envs/AmortizedNLMEs/lib/python3.9/site-packages/matplotlib/_api/deprecation.py:454\u001B[0m, in \u001B[0;36mmake_keyword_only.<locals>.wrapper\u001B[0;34m(*args, **kwargs)\u001B[0m\n\u001B[1;32m    448\u001B[0m \u001B[38;5;28;01mif\u001B[39;00m \u001B[38;5;28mlen\u001B[39m(args) \u001B[38;5;241m>\u001B[39m name_idx:\n\u001B[1;32m    449\u001B[0m     warn_deprecated(\n\u001B[1;32m    450\u001B[0m         since, message\u001B[38;5;241m=\u001B[39m\u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mPassing the \u001B[39m\u001B[38;5;132;01m%(name)s\u001B[39;00m\u001B[38;5;124m \u001B[39m\u001B[38;5;132;01m%(obj_type)s\u001B[39;00m\u001B[38;5;124m \u001B[39m\u001B[38;5;124m\"\u001B[39m\n\u001B[1;32m    451\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mpositionally is deprecated since Matplotlib \u001B[39m\u001B[38;5;132;01m%(since)s\u001B[39;00m\u001B[38;5;124m; the \u001B[39m\u001B[38;5;124m\"\u001B[39m\n\u001B[1;32m    452\u001B[0m         \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mparameter will become keyword-only \u001B[39m\u001B[38;5;132;01m%(removal)s\u001B[39;00m\u001B[38;5;124m.\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    453\u001B[0m         name\u001B[38;5;241m=\u001B[39mname, obj_type\u001B[38;5;241m=\u001B[39m\u001B[38;5;124mf\u001B[39m\u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mparameter of \u001B[39m\u001B[38;5;132;01m{\u001B[39;00mfunc\u001B[38;5;241m.\u001B[39m\u001B[38;5;18m__name__\u001B[39m\u001B[38;5;132;01m}\u001B[39;00m\u001B[38;5;124m()\u001B[39m\u001B[38;5;124m\"\u001B[39m)\n\u001B[0;32m--> 454\u001B[0m \u001B[38;5;28;01mreturn\u001B[39;00m \u001B[43mfunc\u001B[49m\u001B[43m(\u001B[49m\u001B[38;5;241;43m*\u001B[39;49m\u001B[43margs\u001B[49m\u001B[43m,\u001B[49m\u001B[43m \u001B[49m\u001B[38;5;241;43m*\u001B[39;49m\u001B[38;5;241;43m*\u001B[39;49m\u001B[43mkwargs\u001B[49m\u001B[43m)\u001B[49m\n",
      "File \u001B[0;32m~/miniconda/envs/AmortizedNLMEs/lib/python3.9/site-packages/matplotlib/axes/_base.py:3650\u001B[0m, in \u001B[0;36m_AxesBase.set_xlim\u001B[0;34m(self, left, right, emit, auto, xmin, xmax)\u001B[0m\n\u001B[1;32m   3648\u001B[0m         \u001B[38;5;28;01mraise\u001B[39;00m \u001B[38;5;167;01mTypeError\u001B[39;00m(\u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mCannot pass both \u001B[39m\u001B[38;5;124m'\u001B[39m\u001B[38;5;124mright\u001B[39m\u001B[38;5;124m'\u001B[39m\u001B[38;5;124m and \u001B[39m\u001B[38;5;124m'\u001B[39m\u001B[38;5;124mxmax\u001B[39m\u001B[38;5;124m'\u001B[39m\u001B[38;5;124m\"\u001B[39m)\n\u001B[1;32m   3649\u001B[0m     right \u001B[38;5;241m=\u001B[39m xmax\n\u001B[0;32m-> 3650\u001B[0m \u001B[38;5;28;01mreturn\u001B[39;00m \u001B[38;5;28;43mself\u001B[39;49m\u001B[38;5;241;43m.\u001B[39;49m\u001B[43mxaxis\u001B[49m\u001B[38;5;241;43m.\u001B[39;49m\u001B[43m_set_lim\u001B[49m\u001B[43m(\u001B[49m\u001B[43mleft\u001B[49m\u001B[43m,\u001B[49m\u001B[43m \u001B[49m\u001B[43mright\u001B[49m\u001B[43m,\u001B[49m\u001B[43m \u001B[49m\u001B[43memit\u001B[49m\u001B[38;5;241;43m=\u001B[39;49m\u001B[43memit\u001B[49m\u001B[43m,\u001B[49m\u001B[43m \u001B[49m\u001B[43mauto\u001B[49m\u001B[38;5;241;43m=\u001B[39;49m\u001B[43mauto\u001B[49m\u001B[43m)\u001B[49m\n",
      "File \u001B[0;32m~/miniconda/envs/AmortizedNLMEs/lib/python3.9/site-packages/matplotlib/axis.py:1229\u001B[0m, in \u001B[0;36mAxis._set_lim\u001B[0;34m(self, v0, v1, emit, auto)\u001B[0m\n\u001B[1;32m   1227\u001B[0m \u001B[38;5;28;01mfor\u001B[39;00m other \u001B[38;5;129;01min\u001B[39;00m \u001B[38;5;28mself\u001B[39m\u001B[38;5;241m.\u001B[39maxes\u001B[38;5;241m.\u001B[39m_shared_axes[name]\u001B[38;5;241m.\u001B[39mget_siblings(\u001B[38;5;28mself\u001B[39m\u001B[38;5;241m.\u001B[39maxes):\n\u001B[1;32m   1228\u001B[0m     \u001B[38;5;28;01mif\u001B[39;00m other \u001B[38;5;129;01mis\u001B[39;00m \u001B[38;5;129;01mnot\u001B[39;00m \u001B[38;5;28mself\u001B[39m\u001B[38;5;241m.\u001B[39maxes:\n\u001B[0;32m-> 1229\u001B[0m         \u001B[43mother\u001B[49m\u001B[38;5;241;43m.\u001B[39;49m\u001B[43m_axis_map\u001B[49m\u001B[43m[\u001B[49m\u001B[43mname\u001B[49m\u001B[43m]\u001B[49m\u001B[38;5;241;43m.\u001B[39;49m\u001B[43m_set_lim\u001B[49m\u001B[43m(\u001B[49m\n\u001B[1;32m   1230\u001B[0m \u001B[43m            \u001B[49m\u001B[43mv0\u001B[49m\u001B[43m,\u001B[49m\u001B[43m \u001B[49m\u001B[43mv1\u001B[49m\u001B[43m,\u001B[49m\u001B[43m \u001B[49m\u001B[43memit\u001B[49m\u001B[38;5;241;43m=\u001B[39;49m\u001B[38;5;28;43;01mFalse\u001B[39;49;00m\u001B[43m,\u001B[49m\u001B[43m \u001B[49m\u001B[43mauto\u001B[49m\u001B[38;5;241;43m=\u001B[39;49m\u001B[43mauto\u001B[49m\u001B[43m)\u001B[49m\n\u001B[1;32m   1231\u001B[0m         \u001B[38;5;28;01mif\u001B[39;00m other\u001B[38;5;241m.\u001B[39mfigure \u001B[38;5;241m!=\u001B[39m \u001B[38;5;28mself\u001B[39m\u001B[38;5;241m.\u001B[39mfigure:\n\u001B[1;32m   1232\u001B[0m             other\u001B[38;5;241m.\u001B[39mfigure\u001B[38;5;241m.\u001B[39mcanvas\u001B[38;5;241m.\u001B[39mdraw_idle()\n",
      "File \u001B[0;32m~/miniconda/envs/AmortizedNLMEs/lib/python3.9/site-packages/matplotlib/axis.py:1217\u001B[0m, in \u001B[0;36mAxis._set_lim\u001B[0;34m(self, v0, v1, emit, auto)\u001B[0m\n\u001B[1;32m   1214\u001B[0m v0, v1 \u001B[38;5;241m=\u001B[39m \u001B[38;5;28mself\u001B[39m\u001B[38;5;241m.\u001B[39mlimit_range_for_scale(v0, v1)\n\u001B[1;32m   1215\u001B[0m v0, v1 \u001B[38;5;241m=\u001B[39m \u001B[38;5;28msorted\u001B[39m([v0, v1], reverse\u001B[38;5;241m=\u001B[39m\u001B[38;5;28mbool\u001B[39m(reverse))\n\u001B[0;32m-> 1217\u001B[0m \u001B[38;5;28;43mself\u001B[39;49m\u001B[38;5;241;43m.\u001B[39;49m\u001B[43mset_view_interval\u001B[49m\u001B[43m(\u001B[49m\u001B[43mv0\u001B[49m\u001B[43m,\u001B[49m\u001B[43m \u001B[49m\u001B[43mv1\u001B[49m\u001B[43m,\u001B[49m\u001B[43m \u001B[49m\u001B[43mignore\u001B[49m\u001B[38;5;241;43m=\u001B[39;49m\u001B[38;5;28;43;01mTrue\u001B[39;49;00m\u001B[43m)\u001B[49m\n\u001B[1;32m   1218\u001B[0m \u001B[38;5;66;03m# Mark viewlims as no longer stale without triggering an autoscale.\u001B[39;00m\n\u001B[1;32m   1219\u001B[0m \u001B[38;5;28;01mfor\u001B[39;00m ax \u001B[38;5;129;01min\u001B[39;00m \u001B[38;5;28mself\u001B[39m\u001B[38;5;241m.\u001B[39maxes\u001B[38;5;241m.\u001B[39m_shared_axes[name]\u001B[38;5;241m.\u001B[39mget_siblings(\u001B[38;5;28mself\u001B[39m\u001B[38;5;241m.\u001B[39maxes):\n",
      "File \u001B[0;32m~/miniconda/envs/AmortizedNLMEs/lib/python3.9/site-packages/matplotlib/axis.py:2211\u001B[0m, in \u001B[0;36m_make_getset_interval.<locals>.setter\u001B[0;34m(self, vmin, vmax, ignore)\u001B[0m\n\u001B[1;32m   2208\u001B[0m \u001B[38;5;28;01mdef\u001B[39;00m \u001B[38;5;21msetter\u001B[39m(\u001B[38;5;28mself\u001B[39m, vmin, vmax, ignore\u001B[38;5;241m=\u001B[39m\u001B[38;5;28;01mFalse\u001B[39;00m):\n\u001B[1;32m   2209\u001B[0m     \u001B[38;5;66;03m# docstring inherited.\u001B[39;00m\n\u001B[1;32m   2210\u001B[0m     \u001B[38;5;28;01mif\u001B[39;00m ignore:\n\u001B[0;32m-> 2211\u001B[0m         \u001B[38;5;28msetattr\u001B[39m(\u001B[38;5;28;43mgetattr\u001B[39;49m\u001B[43m(\u001B[49m\u001B[38;5;28;43mself\u001B[39;49m\u001B[38;5;241;43m.\u001B[39;49m\u001B[43maxes\u001B[49m\u001B[43m,\u001B[49m\u001B[43m \u001B[49m\u001B[43mlim_name\u001B[49m\u001B[43m)\u001B[49m, attr_name, (vmin, vmax))\n\u001B[1;32m   2212\u001B[0m     \u001B[38;5;28;01melse\u001B[39;00m:\n\u001B[1;32m   2213\u001B[0m         oldmin, oldmax \u001B[38;5;241m=\u001B[39m getter(\u001B[38;5;28mself\u001B[39m)\n",
      "File \u001B[0;32m~/miniconda/envs/AmortizedNLMEs/lib/python3.9/site-packages/matplotlib/axes/_base.py:857\u001B[0m, in \u001B[0;36m_AxesBase.viewLim\u001B[0;34m(self)\u001B[0m\n\u001B[1;32m    855\u001B[0m \u001B[38;5;129m@property\u001B[39m\n\u001B[1;32m    856\u001B[0m \u001B[38;5;28;01mdef\u001B[39;00m \u001B[38;5;21mviewLim\u001B[39m(\u001B[38;5;28mself\u001B[39m):\n\u001B[0;32m--> 857\u001B[0m     \u001B[38;5;28;43mself\u001B[39;49m\u001B[38;5;241;43m.\u001B[39;49m\u001B[43m_unstale_viewLim\u001B[49m\u001B[43m(\u001B[49m\u001B[43m)\u001B[49m\n\u001B[1;32m    858\u001B[0m     \u001B[38;5;28;01mreturn\u001B[39;00m \u001B[38;5;28mself\u001B[39m\u001B[38;5;241m.\u001B[39m_viewLim\n",
      "File \u001B[0;32m~/miniconda/envs/AmortizedNLMEs/lib/python3.9/site-packages/matplotlib/axes/_base.py:844\u001B[0m, in \u001B[0;36m_AxesBase._unstale_viewLim\u001B[0;34m(self)\u001B[0m\n\u001B[1;32m    841\u001B[0m \u001B[38;5;28;01mdef\u001B[39;00m \u001B[38;5;21m_unstale_viewLim\u001B[39m(\u001B[38;5;28mself\u001B[39m):\n\u001B[1;32m    842\u001B[0m     \u001B[38;5;66;03m# We should arrange to store this information once per share-group\u001B[39;00m\n\u001B[1;32m    843\u001B[0m     \u001B[38;5;66;03m# instead of on every axis.\u001B[39;00m\n\u001B[0;32m--> 844\u001B[0m     need_scale \u001B[38;5;241m=\u001B[39m {\n\u001B[1;32m    845\u001B[0m         name: \u001B[38;5;28many\u001B[39m(ax\u001B[38;5;241m.\u001B[39m_stale_viewlims[name]\n\u001B[1;32m    846\u001B[0m                   \u001B[38;5;28;01mfor\u001B[39;00m ax \u001B[38;5;129;01min\u001B[39;00m \u001B[38;5;28mself\u001B[39m\u001B[38;5;241m.\u001B[39m_shared_axes[name]\u001B[38;5;241m.\u001B[39mget_siblings(\u001B[38;5;28mself\u001B[39m))\n\u001B[1;32m    847\u001B[0m         \u001B[38;5;28;01mfor\u001B[39;00m name \u001B[38;5;129;01min\u001B[39;00m \u001B[38;5;28mself\u001B[39m\u001B[38;5;241m.\u001B[39m_axis_names}\n\u001B[1;32m    848\u001B[0m     \u001B[38;5;28;01mif\u001B[39;00m \u001B[38;5;28many\u001B[39m(need_scale\u001B[38;5;241m.\u001B[39mvalues()):\n\u001B[1;32m    849\u001B[0m         \u001B[38;5;28;01mfor\u001B[39;00m name \u001B[38;5;129;01min\u001B[39;00m need_scale:\n",
      "File \u001B[0;32m~/miniconda/envs/AmortizedNLMEs/lib/python3.9/site-packages/matplotlib/axes/_base.py:846\u001B[0m, in \u001B[0;36m<dictcomp>\u001B[0;34m(.0)\u001B[0m\n\u001B[1;32m    841\u001B[0m \u001B[38;5;28;01mdef\u001B[39;00m \u001B[38;5;21m_unstale_viewLim\u001B[39m(\u001B[38;5;28mself\u001B[39m):\n\u001B[1;32m    842\u001B[0m     \u001B[38;5;66;03m# We should arrange to store this information once per share-group\u001B[39;00m\n\u001B[1;32m    843\u001B[0m     \u001B[38;5;66;03m# instead of on every axis.\u001B[39;00m\n\u001B[1;32m    844\u001B[0m     need_scale \u001B[38;5;241m=\u001B[39m {\n\u001B[1;32m    845\u001B[0m         name: \u001B[38;5;28many\u001B[39m(ax\u001B[38;5;241m.\u001B[39m_stale_viewlims[name]\n\u001B[0;32m--> 846\u001B[0m                   \u001B[38;5;28;01mfor\u001B[39;00m ax \u001B[38;5;129;01min\u001B[39;00m \u001B[38;5;28;43mself\u001B[39;49m\u001B[38;5;241;43m.\u001B[39;49m\u001B[43m_shared_axes\u001B[49m\u001B[43m[\u001B[49m\u001B[43mname\u001B[49m\u001B[43m]\u001B[49m\u001B[38;5;241;43m.\u001B[39;49m\u001B[43mget_siblings\u001B[49m\u001B[43m(\u001B[49m\u001B[38;5;28;43mself\u001B[39;49m\u001B[43m)\u001B[49m)\n\u001B[1;32m    847\u001B[0m         \u001B[38;5;28;01mfor\u001B[39;00m name \u001B[38;5;129;01min\u001B[39;00m \u001B[38;5;28mself\u001B[39m\u001B[38;5;241m.\u001B[39m_axis_names}\n\u001B[1;32m    848\u001B[0m     \u001B[38;5;28;01mif\u001B[39;00m \u001B[38;5;28many\u001B[39m(need_scale\u001B[38;5;241m.\u001B[39mvalues()):\n\u001B[1;32m    849\u001B[0m         \u001B[38;5;28;01mfor\u001B[39;00m name \u001B[38;5;129;01min\u001B[39;00m need_scale:\n",
      "File \u001B[0;32m~/miniconda/envs/AmortizedNLMEs/lib/python3.9/site-packages/matplotlib/cbook/__init__.py:884\u001B[0m, in \u001B[0;36mGrouper.get_siblings\u001B[0;34m(self, a)\u001B[0m\n\u001B[1;32m    882\u001B[0m \u001B[38;5;28mself\u001B[39m\u001B[38;5;241m.\u001B[39mclean()\n\u001B[1;32m    883\u001B[0m siblings \u001B[38;5;241m=\u001B[39m \u001B[38;5;28mself\u001B[39m\u001B[38;5;241m.\u001B[39m_mapping\u001B[38;5;241m.\u001B[39mget(weakref\u001B[38;5;241m.\u001B[39mref(a), [weakref\u001B[38;5;241m.\u001B[39mref(a)])\n\u001B[0;32m--> 884\u001B[0m \u001B[38;5;28;01mreturn\u001B[39;00m [x() \u001B[38;5;28;01mfor\u001B[39;00m x \u001B[38;5;129;01min\u001B[39;00m siblings]\n",
      "File \u001B[0;32m~/miniconda/envs/AmortizedNLMEs/lib/python3.9/site-packages/matplotlib/cbook/__init__.py:884\u001B[0m, in \u001B[0;36m<listcomp>\u001B[0;34m(.0)\u001B[0m\n\u001B[1;32m    882\u001B[0m \u001B[38;5;28mself\u001B[39m\u001B[38;5;241m.\u001B[39mclean()\n\u001B[1;32m    883\u001B[0m siblings \u001B[38;5;241m=\u001B[39m \u001B[38;5;28mself\u001B[39m\u001B[38;5;241m.\u001B[39m_mapping\u001B[38;5;241m.\u001B[39mget(weakref\u001B[38;5;241m.\u001B[39mref(a), [weakref\u001B[38;5;241m.\u001B[39mref(a)])\n\u001B[0;32m--> 884\u001B[0m \u001B[38;5;28;01mreturn\u001B[39;00m [\u001B[43mx\u001B[49m\u001B[43m(\u001B[49m\u001B[43m)\u001B[49m \u001B[38;5;28;01mfor\u001B[39;00m x \u001B[38;5;129;01min\u001B[39;00m siblings]\n",
      "\u001B[0;31mKeyboardInterrupt\u001B[0m: "
     ]
    }
   ],
   "source": [
    "rows = 10\n",
    "ncols = max(int(np.ceil(len(test_patients) / rows)), 10)\n",
    "fig, ax = plt.subplots(rows, ncols, sharex='all', sharey='all',\n",
    "                       tight_layout=True, figsize=(10, rows*3))\n",
    "axis = ax.flatten()\n",
    "\n",
    "for p_id in range(rows*ncols):\n",
    "    _, _, dose_amount, doses_time_points = convert_to_observables(test_patients[p_id])\n",
    "    t_measurements = np.linspace(0, 700, 100)\n",
    "    sim_data = batch_simulator(bayes_results[p_id][np.newaxis],\n",
    "                        t_measurements=t_measurements,\n",
    "                        t_doses=doses_time_points,\n",
    "                        dose_amount=dose_amount,\n",
    "                        with_noise=False)\n",
    "    \n",
    "    sim_data_posterior = batch_simulator(posterior_draws[p_id],\n",
    "                        t_measurements=t_measurements,\n",
    "                        t_doses=doses_time_points,\n",
    "                        dose_amount=dose_amount,\n",
    "                        with_noise=False)\n",
    "\n",
    "    y_full = []\n",
    "    for s in sim_data:\n",
    "        y, _, _, _ = convert_to_observables(s)\n",
    "        y_full.append(y)\n",
    "        axis[p_id].plot(t_measurements, y, 'r')\n",
    "        axis[p_id].vlines(doses_time_points, 0, np.max(y), color='grey', linestyles='--', alpha=0.5)\n",
    "    for s in sim_data_posterior:\n",
    "        y, _, _, _ = convert_to_observables(s)\n",
    "        y_full.append(y)\n",
    "    axis[p_id].plot(t_measurements, np.median(y_full, axis=0), 'b')\n",
    "\n",
    "    y, t_measurements, _, _ = convert_to_observables(test_patients[p_id])\n",
    "    axis[p_id].scatter(t_measurements, y, color='g')\n",
    "    \n",
    "median, = plt.plot([], [], color='b', label='posterior median')\n",
    "bayes, = plt.plot([], [], color='r', label='emperical bayes estimate')\n",
    "lgd = fig.legend(handles=[median, bayes],\n",
    "            loc='lower center', ncol=2, bbox_to_anchor=(0.5, -0.05))\n",
    "plt.show()"
   ],
   "metadata": {
    "collapsed": false,
    "is_executing": true,
    "ExecuteTime": {
     "start_time": "2023-08-14T19:58:48.378484Z"
    }
   },
   "id": "e3cb620a0e5880a5"
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/Users/jonas.arruda/miniconda/envs/AmortizedNLMEs/lib/python3.9/site-packages/IPython/core/pylabtools.py:152: UserWarning: Tight layout not applied. tight_layout cannot make axes width small enough to accommodate all axes decorations\n",
      "  fig.canvas.print_figure(bytes_io, **kw)\n"
     ]
    }
   ],
   "source": [
    "_, cov = model.load_data(n_data=len(test_patients), load_covariates=True)"
   ],
   "metadata": {
    "collapsed": false,
    "is_executing": true,
    "ExecuteTime": {
     "start_time": "2023-08-14T19:59:08.900432Z"
    }
   },
   "id": "168356792d094b58"
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "outputs": [],
   "source": [
    "fig, ax = plt.subplots(nrows=bayes_results[0].shape[0], ncols=2, figsize=(10, 10), layout='tight',\n",
    "                       sharex='col', sharey='row')\n",
    "\n",
    "for param_id in range(bayes_results[0].shape[0]):\n",
    "    for p_id in range(len(test_patients)):\n",
    "        ax[param_id, 0].scatter(cov[p_id, 0], np.exp(bayes_results[p_id][param_id]), color='blue')\n",
    "        ax[param_id, 1].scatter(cov[p_id, 1], np.exp(bayes_results[p_id][param_id]), color='blue')\n",
    "    ax[param_id, 0].set_ylabel(f'{model.param_names[param_id]}')\n",
    "        \n",
    "ax[0, 0].set_title('age')\n",
    "ax[0, 1].set_title('previous infection')\n",
    "plt.show()"
   ],
   "metadata": {
    "collapsed": false,
    "is_executing": true,
    "ExecuteTime": {
     "start_time": "2023-08-14T20:05:14.956303Z"
    }
   },
   "id": "e80a9566e9d6b2d8"
  },
  {
   "cell_type": "code",
   "execution_count": 39,
   "outputs": [],
   "source": [
    "save_array = np.array(bayes_results)\n",
    "np.save(f'bayes_clairon.npy', save_array)"
   ],
   "metadata": {
    "collapsed": false,
    "ExecuteTime": {
     "end_time": "2023-08-14T20:02:32.934247Z",
     "start_time": "2023-08-14T20:02:32.931166Z"
    }
   },
   "id": "21b4942cd4e68f79"
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "outputs": [],
   "source": [],
   "metadata": {
    "collapsed": false
   },
   "id": "a8d4fffc09c3b1cf"
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.16"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
